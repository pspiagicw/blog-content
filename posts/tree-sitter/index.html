<!DOCTYPE html>
<html lang="en-us">

<head>
    <title>
Tree-Sitting | pspiagicw
</title>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="generator" content="Hugo 0.123.8">


<link rel="canonical" href="/posts/tree-sitter/" >
<link href="/sass/main.min.580ea0f431d735692e843e1b12975baa38435b3b65dfad2765db4af8ba89642f.css" rel="stylesheet">

<script src="https://kit.fontawesome.com/f250909d17.js" crossorigin="anonymous"></script>



</head>

<body>

    <div class="flexWrapper">
        <header class="headerWrapper">
    <div class="header">
        <div>
            <a href="/">
                <span class="terminal">pspiagicw@falconite $</span>
            </a>
        </div>
        <input class="side-menu" type="checkbox" id="side-menu">
        <label class="hamb" for="side-menu"><span class="hamb-line"></span></label>
        <nav class="headerLinks">
            <ul>
                
                <li>
                    <a href="/" title="" >
                        ~/home</a>
                </li>
                
                <li>
                    <a href="/posts" title="" >
                        ~/writing</a>
                </li>
                
                <li>
                    <a href="/about" title="" >
                        ~/about</a>
                </li>
                
            </ul>
        </nav>
    </div>
</header>


        <div class="content">
            <main class="main">
                
<div class="postWrapper">
    <h1>Tree-Sitting</h1>
    
    <section class="postMetadata">
        <dl>
            
            
                <dt>published</dt>
                
                <dd><time datetime="2024-03-25">Mar 25, 2024</time></dd>
            
            
                <dt>reading time</dt>
                <dd>19 minutes</dd>
            
        </dl>
    </section>
    
    <div>
        <p>This is a post on how I wrote a tree-sitter parser for a new language. and how I integrated it into my editor.</p>
<p>The new language being my toy language, <a href="https://github.com/pspiagicw/hotshot">hotshot</a>.
This language is a LISP-like scripting language.</p>
<p>Here is a snippet of the language:</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">fn</span> <span style="color:#f5e0dc">fibonacci</span> (<span style="color:#89b4fa">n</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>  (<span style="color:#cba6f7">cond </span>((<span style="color:#89dceb">&lt; </span><span style="color:#f5e0dc">n</span> <span style="color:#fab387">1</span>) <span style="color:#fab387">0</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>        ((<span style="color:#89dceb">= </span><span style="color:#f5e0dc">n</span> <span style="color:#fab387">1</span>) <span style="color:#fab387">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>        (<span style="color:#89b4fa">true</span> (<span style="color:#89dceb">+ </span>(<span style="color:#89b4fa">fibonacci</span> (<span style="color:#89dceb">- </span><span style="color:#f5e0dc">n</span> <span style="color:#fab387">1</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>                 (<span style="color:#89b4fa">fibonacci</span> (<span style="color:#89dceb">- </span><span style="color:#f5e0dc">n</span> <span style="color:#fab387">2</span>))))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>(<span style="color:#89b4fa">assert</span> (<span style="color:#89b4fa">fibonacci</span> <span style="color:#fab387">7</span>) <span style="color:#fab387">13</span> <span style="color:#a6e3a1">&#34;fibonacci failed&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8">8</a></span><span>(<span style="color:#89b4fa">assert</span> (<span style="color:#89b4fa">fibonacci</span> <span style="color:#fab387">10</span>) <span style="color:#fab387">55</span> <span style="color:#a6e3a1">&#34;fibonacci failed&#34;</span>)
</span></span></code></pre></div><p>Notice how the syntax highlighting is pretty shit.</p>
<p>By the end of this post, you will be able to fix just that (Atleast in your editor)</p>
<hr>
<p>Before:</p>
<p><img src="before.png" alt="Before"></p>
<p>After:</p>
<p><img src="after.png" alt="After"></p>
<hr>
<h2 id="tree-sitter">Tree-Sitter</h2>
<p>I like using <code>neovim</code>.</p>
<p>Editors like <code>neovim</code> including <code>emacs</code>, <code>kakoune</code> and <code>helix</code> use the <code>tree-sitter</code> library for syntax highlighting.</p>
<p>Developed for the <code>atom</code> editor, it&rsquo;s a incremental parsing library that can perform syntax highlighting, indentation and other wizardry.</p>
<p>It is faster and more accurate than the traditional regex-based highlighting/identation.</p>
<p>My previous post on the <a href="https://falconite.xyz/posts/microservices-and-editors/">composition of editors</a> has more info on it&rsquo;s working.</p>
<p>See the <a href="https://tree-sitter.github.io/tree-sitter">tree-sitter official docs</a> for complete information.</p>
<hr>
<h2 id="dependencies">Dependencies</h2>
<p>You will need</p>
<ul>
<li>
<p>Node (The <code>docs</code> mention <code>v6.0</code> or higher, but my advice is to use the latest version)</p>
</li>
<li>
<p><code>tree-sitter-cli</code>, my advice is to download the latest version from the <a href="https://github.com/tree-sitter/tree-sitter/releases">release page</a>.</p>
</li>
</ul>
<p>You can also install <code>tree-sitter-cli</code> from <code>npm</code>, and you will have to configure your PATH to include the <code>node_modules/.bin</code> directory.</p>
<hr>
<h2 id="getting-started">Getting Started</h2>
<ul>
<li>Create a directory called <code>tree-sitter-hotshot</code>.</li>
<li>Inside this directory, create a <code>grammar.js</code> file.</li>
</ul>
<p>You can get started with te following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">// grammar.js 
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span><span style="color:#6c7086;font-style:italic"></span>module.exports <span style="color:#89dceb;font-weight:bold">=</span> grammar({
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>    <span style="color:#6c7086;font-style:italic">// name of your language
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span><span style="color:#6c7086;font-style:italic"></span>    name<span style="color:#89dceb;font-weight:bold">:</span> <span style="color:#a6e3a1">&#39;hotshot&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>    rules<span style="color:#89dceb;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>        source_file<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#a6e3a1">&#39;hello&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8">8</a></span><span>    }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9">9</a></span><span>});
</span></span></code></pre></div><hr>
<h2 id="grammar">Grammar</h2>
<p>Tree-Sitter grammar works on <code>rules</code>. A <code>rule</code> in essence is</p>
<ul>
<li>
<p>A regex to match with text in the source file</p>
</li>
<li>
<p>A combination of other rules (More on that later)</p>
</li>
<li>
<p>A string to match with text.</p>
</li>
</ul>
<p>Tree-Sitter needs only a single rule <code>source_file</code> to declared.
It will start parsing the source code according to this rule.</p>
<p><em>It helps if you are familiar with <code>BNF</code> forms or used <code>ANTLR</code>/<code>bison</code>/<code>yacc</code></em></p>
<p>The grammar currently has a single rule, that matches the text <code>hello</code>.</p>
<p>Generate the parser by running the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-zsh" data-lang="zsh"><span style="display:flex;"><span>tree-sitter generate
</span></span></code></pre></div><p>It should create a shitload of files in the current directory.</p>
<p>You never have to directly interact with these files, tree-sitter manages these for us.</p>
<p>Although these are important files for the future. If you are using <code>git</code> add them into the repository.</p>
<p>The important files are</p>
<ul>
<li><code>grammar.js</code></li>
<li><code>package.json</code></li>
</ul>
<hr>
<h2 id="writing-the-grammar">Writing the Grammar</h2>
<h3 id="expression">expression</h3>
<p>In my language, most statement returns some value.</p>
<p>It can have a single <code>string</code>, <code>boolean</code> or <code>integer</code> as a statement.</p>
<p>Example</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; this is a coment BTW :) ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span><span style="color:#a6e3a1">&#34;hello world&#34;</span> <span style="color:#6c7086;font-style:italic">; =&gt; return &#34;hello world&#34;;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span><span style="color:#fab387">69</span> <span style="color:#6c7086;font-style:italic">; =&gt; return 69 ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span><span style="color:#f5e0dc">true</span> <span style="color:#6c7086;font-style:italic">; =&gt; return true ;</span>
</span></span></code></pre></div><p>Let&rsquo;s add support for <code>integer</code>, we can add support for other types incrementally.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>module.exports <span style="color:#89dceb;font-weight:bold">=</span> grammar({
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  name<span style="color:#89dceb;font-weight:bold">:</span> <span style="color:#a6e3a1">&#39;hotshot&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>  rules<span style="color:#89dceb;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      <span style="color:#6c7086;font-style:italic">// Source file has multiple statement
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span><span style="color:#6c7086;font-style:italic"></span>      source_file<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; repeat($.statement),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>      <span style="color:#6c7086;font-style:italic">// Statement can have a expression
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span><span style="color:#6c7086;font-style:italic"></span>      statement<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>        $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>      <span style="color:#6c7086;font-style:italic">// Expression can have a integer
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span><span style="color:#6c7086;font-style:italic"></span>      expression<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>        $.integer,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>      ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>      <span style="color:#6c7086;font-style:italic">// Regex
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span><span style="color:#6c7086;font-style:italic"></span>      integer<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span><span style="color:#f38ba8">\</span>d<span style="color:#89dceb;font-weight:bold">+</span><span style="color:#f38ba8">/</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>  }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>});
</span></span></code></pre></div><ul>
<li>
<p>Rules are declared  with the syntax <code>rule_name: $ =&gt; &lt;rule-content&gt;</code>.</p>
</li>
<li>
<p>Rules are referenced with syntax <code>$.&lt;rule-name&gt;</code>.</p>
</li>
</ul>
<p>The above grammar includes special functions like <code>repeat</code> and <code>choice</code>.</p>
<ul>
<li>
<p><code>repeat</code> means the child rule can occur zero or more times.</p>
</li>
<li>
<p><code>choice</code> means only one of the child rules will be matched</p>
</li>
</ul>
<p>In essence it means,</p>
<ul>
<li>
<p>a <code>source_file</code> can have zero or more <code>statement</code>.</p>
</li>
<li>
<p>a <code>statement</code> can be of type <code>expression</code></p>
</li>
<li>
<p>a <code>expression</code> can be of type <code>integer</code></p>
</li>
<li>
<p>a <code>integer</code> consists of consecutive one or more digits.</p>
</li>
</ul>
<p>The <code>integer</code> rule uses <code>Regular Expressions</code>, to declare one or more consecutive digits to be a <code>integer</code>.</p>
<blockquote>
<p><em>If you want to implement rules in <code>tree-sitter</code>, you need to be comfortable with <code>regex</code></em></p>
</blockquote>
<blockquote>
<p>There are multiple times in this post, you will be required to use <code>tree-sitter</code> to test and parse source code.</p>
<p>It goes without saying, you need to run <code>tree-sitter generate</code> each time, before doing any testing or parsing.</p>
</blockquote>
<h3 id="testing-the-parser">testing the parser</h3>
<p>We can write a few <code>hotshot</code> programs to test if the parsing is accurate.</p>
<p>Save this under <code>programs/integer.ht</code>. We will use the <code>programs</code> directory to store example files.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#fab387">420</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span><span style="color:#fab387">69</span>
</span></span></code></pre></div><blockquote>
<p><em>Tree-Sitter has a full fledged testing framework embedded into it.
But it&rsquo;s not recommended for beginners. It is also quite not useful for such a small grammar.</em></p>
<p><em>You can refer it <a href="https://tree-sitter.github.io/tree-sitter/creating-parsers#command-test">here</a> later</em></p>
</blockquote>
<p>We will be using a simple command to test the parser.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic"># Parses all `hotshot` programs and prints only the stats</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>tree-sitter parse --quiet --stat programs/*.ht
</span></span></code></pre></div><p>To test a single file run</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic"># Replace `programs/integer.ht` with your file</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>tree-sitter parse programs/integer.ht
</span></span></code></pre></div><p>It should output</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>    (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>      (<span style="color:#89b4fa">integer</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>    (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>      (<span style="color:#89b4fa">integer</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>]))))
</span></span></code></pre></div><p>You can clearly see the AST built for our language here.</p>
<hr>
<h3 id="comments">comments</h3>
<p>We can add support for comments by adding the following rule to the grammar:</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>module.exports <span style="color:#89dceb;font-weight:bold">=</span> grammar({
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>    name<span style="color:#89dceb;font-weight:bold">:</span> <span style="color:#a6e3a1">&#39;hotshot&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    extras<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; [$.comment, <span style="color:#94e2d5">/\s/</span>], <span style="color:#6c7086;font-style:italic">// Add this line
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>    rules<span style="color:#89dceb;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>        source_file<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; repeat($.statement),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>        <span style="color:#6c7086;font-style:italic">// ...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>        <span style="color:#6c7086;font-style:italic">// Add this line
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span><span style="color:#6c7086;font-style:italic"></span>        comment<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span>;[<span style="color:#89dceb;font-weight:bold">^</span>;]<span style="color:#89dceb;font-weight:bold">*</span>;<span style="color:#f38ba8">/</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>   }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>});
</span></span></code></pre></div><ul>
<li>
<p>The <code>extras</code> rule is used to specify the tokens that are not part of the syntax tree, but are still important for the parser.</p>
</li>
<li>
<p>The <code>/\s/</code> means all the whitespace characters like space, tabs and newlines.</p>
</li>
</ul>
<p><code>hotshot</code> supports <code>inline</code> comments. Meaning <code>(+ 1 ;some comments here; 2)</code> is a valid statement.</p>
<p>That&rsquo;s the reason I have added <code>comments</code> to the <code>extras</code> field.</p>
<p>If your language integrates comments into the syntax tree, you can add it to the <code>statement</code> rule.</p>
<blockquote>
<p><em>If comments are not part of the AST, why are they parsed?</em></p>
<p>They are parsed because they are still important to the source code.
Features like syntax highlighting and indentation still apply to comments.</p>
</blockquote>
<h3 id="more-expressions">more expressions</h3>
<p>Now that we have added support for <code>integers</code> and <code>comments</code>, we can add support for <code>strings</code> and <code>booleans</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">// ...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>      expression<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>        $.integer,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>        $.<span style="color:#cba6f7">boolean</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>        $.string
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>      integer<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span><span style="color:#f38ba8">\</span>d<span style="color:#89dceb;font-weight:bold">+</span><span style="color:#f38ba8">/,</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>      string<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span><span style="color:#a6e3a1">&#34;[^&#34;</span>]<span style="color:#89dceb;font-weight:bold">*</span><span style="color:#f38ba8">&#34;</span><span style="color:#89dceb;font-weight:bold">/</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      <span style="color:#cba6f7">boolean</span><span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>        <span style="color:#a6e3a1">&#39;true&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>        <span style="color:#a6e3a1">&#39;false&#39;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>      )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span><span style="color:#6c7086;font-style:italic">//....
</span></span></span></code></pre></div><p>Here&rsquo;s a example code that has all types of expressions, along with comments.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; this is a comment ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span><span style="color:#6c7086;font-style:italic">; programs/data.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span><span style="color:#fab387">69</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span><span style="color:#a6e3a1">&#34;this is a string&#34;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8">8</a></span><span><span style="color:#f5e0dc">true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9">9</a></span><span><span style="color:#f5e0dc">false</span>
</span></span></code></pre></div><p>If you run <code>tree-sitter parse programs/data.ht</code>. You should get a output like this.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">9</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span> (<span style="color:#89b4fa">comments</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span> (<span style="color:#89b4fa">comments</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>   (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>     (<span style="color:#89b4fa">integer</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>   (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>     (<span style="color:#89dceb">string </span>[<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>   (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>     (<span style="color:#89b4fa">boolean</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>   (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>     (<span style="color:#89b4fa">boolean</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>]))))
</span></span></code></pre></div><hr>
<h3 id="hello-world">hello-world</h3>
<p>Let&rsquo;s add support for the most overrated program of all time, the <code>hello-world</code> program.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/hello-world.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>(<span style="color:#f5e0dc">echo</span> <span style="color:#a6e3a1">&#34;Hello, World!&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span><span style="color:#6c7086;font-style:italic">;`echo` is a built-in function in `hotshot`. ;</span>
</span></span></code></pre></div><p>If you run the test before writing the actual rules.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>tree-sitter parse programs/hello-world.ht
</span></span></code></pre></div><p>It gives an error, because we haven&rsquo;t added support for <code>function calls</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>  (<span style="color:#89b4fa">ERROR</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>    (<span style="color:#89b4fa">ERROR</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span><span style="color:#f5e0dc">programs/hello-world</span><span style="color:#89dceb;font-weight:bold">.</span><span style="color:#f5e0dc">ht</span>    <span style="color:#fab387">0.02</span> <span style="color:#f5e0dc">ms</span>         <span style="color:#fab387">909</span> <span style="color:#f5e0dc">bytes/ms</span> (<span style="color:#89b4fa">ERROR</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>])
</span></span></code></pre></div><p>Function calls in <code>hotshot</code> are represented by the following syntax:</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#f5e0dc">function-name</span> <span style="color:#f5e0dc">arg1</span> <span style="color:#f5e0dc">arg2</span> <span style="color:#f5e0dc">arg3</span>)
</span></span></code></pre></div><p>Add the following code. It has quite a few rules, but don&rsquo;t fret.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">// ...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>    statement<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>      <span style="color:#6c7086;font-style:italic">// Paren statement
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span><span style="color:#6c7086;font-style:italic"></span>      $.sparen
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>    <span style="color:#6c7086;font-style:italic">// Paren Statement =&gt; &#39;(&#39;, paren ,&#39;)&#39;
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span><span style="color:#6c7086;font-style:italic"></span>    sparen<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.paren ,<span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>    paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      $.fcall,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>    fcall<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(field(<span style="color:#a6e3a1">&#39;name&#39;</span>, $.fname), repeat(field(<span style="color:#a6e3a1">&#39;argument&#39;</span>, $.returnable))),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>    returnable<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.fcall , <span style="color:#a6e3a1">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>    expression<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>      $.integer,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span>      $.<span style="color:#cba6f7">boolean</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-25"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-25">25</a></span><span>      $.string,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-26"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-26">26</a></span><span>      $.identifier
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-27"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-27">27</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-28"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-28">28</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-29"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-29">29</a></span><span>    fname<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-30"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-30">30</a></span><span>      $.identifier
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-31"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-31">31</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-32"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-32">32</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-33"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-33">33</a></span><span>    identifier<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span>[a<span style="color:#89dceb;font-weight:bold">-</span>zA<span style="color:#89dceb;font-weight:bold">-</span>Z]<span style="color:#89dceb;font-weight:bold">+</span><span style="color:#f38ba8">/,</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-34"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-34">34</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-35"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-35">35</a></span><span>    <span style="color:#6c7086;font-style:italic">// ...
</span></span></span></code></pre></div><ul>
<li>
<p>The above code introduces the tree-sitter function <code>seq</code>.</p>
<p>This dictates a sequence of rules, in a specific order.</p>
</li>
<li>
<p>It also has the <code>field</code> function.</p>
<p>This function tags the child rule with a name, that we can see in the AST.</p>
</li>
<li>
<p>The code adds rules for <code>identifiers</code> (variables).</p>
</li>
<li>
<p>Identifiers are defined as a sequence of one or more alphabets.</p>
</li>
</ul>
<blockquote>
<p><code>returnables</code> are different from <code>statements</code>.</p>
<p><code>hotshot</code> has few statements that aren&rsquo;t supposed to evaluate into values, like function declaration etc.</p>
<p>They will be syntax highlighted differently thus separating them from other expressions is required.</p>
<p>I have made separate rule for those that evaluate to values.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">27</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>    (<span style="color:#89b4fa">sparen</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      (<span style="color:#89b4fa">paren</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">fname</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>            (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">returnable</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>            (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>              (<span style="color:#89dceb">string </span>[<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]))))))))
</span></span></code></pre></div><hr>
<p>If you can see, we have a lot of <code>psuedo</code> nodes, like <code>sparen</code>, <code>paren</code>, <code>fname</code>.</p>
<p>In tree-sitter syntax, you can add a <code>_</code> in front of a rule to make it a <code>hidden</code> rule.</p>
<p>Here&rsquo;s the entire grammar with the hidden rules.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>module.exports <span style="color:#89dceb;font-weight:bold">=</span> grammar({
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  name<span style="color:#89dceb;font-weight:bold">:</span> <span style="color:#a6e3a1">&#39;hotshot&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>  extras<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; [$.comment, <span style="color:#94e2d5">/\s/</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>  rules<span style="color:#89dceb;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>    source_file<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; repeat($.statement),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>    statement<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      $._sparen
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>    _sparen<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $._paren ,<span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>    _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>      $.fcall
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>    fcall<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(field(<span style="color:#a6e3a1">&#39;name&#39;</span>, $._fname), repeat(field(<span style="color:#a6e3a1">&#39;argument&#39;</span>, $._returnable))),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>    _returnable<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-25"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-25">25</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.fcall , <span style="color:#a6e3a1">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-26"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-26">26</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-27"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-27">27</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-28"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-28">28</a></span><span>    expression<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-29"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-29">29</a></span><span>      $.integer,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-30"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-30">30</a></span><span>      $.<span style="color:#cba6f7">boolean</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-31"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-31">31</a></span><span>      $.string,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-32"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-32">32</a></span><span>      $.identifier
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-33"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-33">33</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-34"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-34">34</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-35"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-35">35</a></span><span>    _fname<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-36"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-36">36</a></span><span>      $.identifier
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-37"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-37">37</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-38"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-38">38</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-39"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-39">39</a></span><span>    integer<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span><span style="color:#f38ba8">\</span>d<span style="color:#89dceb;font-weight:bold">+</span><span style="color:#f38ba8">/,</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-40"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-40">40</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-41"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-41">41</a></span><span>    <span style="color:#cba6f7">boolean</span><span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(<span style="color:#a6e3a1">&#39;true&#39;</span>, <span style="color:#a6e3a1">&#39;false&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-42"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-42">42</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-43"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-43">43</a></span><span>    identifier<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span>[a<span style="color:#89dceb;font-weight:bold">-</span>zA<span style="color:#89dceb;font-weight:bold">-</span>Z]<span style="color:#89dceb;font-weight:bold">+</span><span style="color:#f38ba8">/,</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-44"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-44">44</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-45"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-45">45</a></span><span>    string<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span><span style="color:#a6e3a1">&#34;[^&#34;</span>]<span style="color:#89dceb;font-weight:bold">*</span><span style="color:#f38ba8">&#34;</span><span style="color:#89dceb;font-weight:bold">/</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-46"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-46">46</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-47"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-47">47</a></span><span>    comment<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; <span style="color:#89dceb;font-weight:bold">/</span>;[<span style="color:#89dceb;font-weight:bold">^</span>;]<span style="color:#89dceb;font-weight:bold">*</span>;<span style="color:#f38ba8">/</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-48"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-48">48</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-49"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-49">49</a></span><span>  }
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-50"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-50">50</a></span><span>});
</span></span></code></pre></div><p>The <code>hello-world</code> program should parse much cleanly now.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">27</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">1</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>    (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>      <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8">8</a></span><span>        (<span style="color:#89dceb">string </span>[<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>])))))
</span></span></code></pre></div><hr>
<h3 id="let">let</h3>
<p>Let&rsquo;s examine the <code>let</code> statement</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#cba6f7">let</span> <span style="color:#f5e0dc">a</span> <span style="color:#fab387">1</span>)
</span></span></code></pre></div><p>This statement can be parsed as <code>(function-call arg1 arg2)</code>, which is kinda wrong syntax wise.</p>
<p>It&rsquo;s a separate statement altogether, not a function-call. I want it selected and syntax-highlighted as a separate statement.</p>
<p>But if I put <code>fcall</code> as a expression, there would no way of differenciating the <code>let</code> statement from any other <code>function call</code></p>
<p>It&rsquo;s the reason I added the <code>returnable</code> , <code>sparen</code> and <code>paren</code> rules.</p>
<blockquote>
<p>There is way to prevent adding them.</p>
<p><em>It&rsquo;s to use precedence in defining rules.
It tells tree-sitter to give precedence to one kind of statements over another.</em></p>
<p>But <code>precedence</code> is a big topic and a overkill for such a simple language.</p>
</blockquote>
<p>For the <code>let</code> statements, add the following code.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">// ..
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>      $.fcall, <span style="color:#6c7086;font-style:italic">// Don&#39;t forget this comma
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span><span style="color:#6c7086;font-style:italic"></span>      $.<span style="color:#f38ba8">let</span> <span style="color:#6c7086;font-style:italic">// Add this line
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span><span style="color:#6c7086;font-style:italic"></span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>    <span style="color:#6c7086;font-style:italic">// rule for &#39;let&#39; statements.
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span><span style="color:#6c7086;font-style:italic"></span>    <span style="color:#f38ba8">let</span><span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(<span style="color:#a6e3a1">&#39;let&#39;</span>, field(<span style="color:#a6e3a1">&#39;name&#39;</span>, $.identifier), field(<span style="color:#a6e3a1">&#39;value&#39;</span>, $.expression)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>    
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>    <span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span><span style="color:#6c7086;font-style:italic">//.. 
</span></span></span></code></pre></div><p>Write the test program to parse.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/variables.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>(<span style="color:#cba6f7">let</span> <span style="color:#f5e0dc">a</span> <span style="color:#fab387">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>(<span style="color:#f5e0dc">echo</span> <span style="color:#f5e0dc">a</span>)
</span></span></code></pre></div><p>It should produce the following AST.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    (<span style="color:#cba6f7">let </span>[<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      <span style="color:#f5e0dc">value:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>        (<span style="color:#89b4fa">integer</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>]))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>    (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>      <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>        (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>])))))
</span></span></code></pre></div><hr>
<h3 id="control-flow">control-flow</h3>
<p>Now that we have added support for <code>let</code> statements, we can add support for <code>control-flow</code> statements.</p>
<p>This includes <code>if</code>, <code>cond</code> and <code>while</code> statements.</p>
<p>We can skim over these quite quickly as they are easy to implement and test.</p>
<hr>
<h3 id="if">if</h3>
<p><code>if</code> statements in <code>hotshot</code> have a simple syntax.
Both the <code>body</code> and <code>else</code> have a single statement.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#cba6f7">if </span><span style="color:#f5e0dc">condition</span> <span style="color:#f5e0dc">body-statement</span> <span style="color:#f5e0dc">else-statement</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span><span style="color:#6c7086;font-style:italic">; The else part is optional ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>(<span style="color:#cba6f7">if </span><span style="color:#f5e0dc">condition</span> <span style="color:#f5e0dc">body-statement</span>)
</span></span></code></pre></div><ul>
<li>Test Program</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/if.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>(<span style="color:#cba6f7">if</span> <span style="color:#f5e0dc">true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>  (<span style="color:#f5e0dc">echo</span> <span style="color:#a6e3a1">&#34;true&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>  (<span style="color:#f5e0dc">echo</span> <span style="color:#a6e3a1">&#34;false&#34;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>(<span style="color:#cba6f7">if</span> (<span style="color:#f5e0dc">somefunction</span>) <span style="color:#a6e3a1">&#34;true&#34;</span>)
</span></span></code></pre></div><ul>
<li>Code</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>     _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>       $.fcall,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>       $.<span style="color:#f38ba8">let</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>       $.<span style="color:#cba6f7">if</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>     ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>     <span style="color:#cba6f7">if</span><span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>       <span style="color:#a6e3a1">&#39;if&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>       field(<span style="color:#a6e3a1">&#39;condition&#39;</span>, $._returnable),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>       field(<span style="color:#a6e3a1">&#39;body&#39;</span>,$.statement),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>       optional(field(<span style="color:#a6e3a1">&#39;else&#39;</span>, $.statement)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>     )),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>    <span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>    <span style="color:#6c7086;font-style:italic">// If statements can return value, thus add them into returnable
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _returnable<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.fcall , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">if</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span>    <span style="color:#6c7086;font-style:italic">//...
</span></span></span></code></pre></div><ul>
<li>
<p>The above code has a new function <code>optional</code>.</p>
<p>This function makes it&rsquo;s argument optional.
Cause a <code>if</code> statement might not have a <code>else</code> part.</p>
</li>
<li>
<p>Output</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">23</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">17</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    (<span style="color:#cba6f7">if </span>[<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>        (<span style="color:#89b4fa">boolean</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>]))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      <span style="color:#f5e0dc">else:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>]))))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">26</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>    (<span style="color:#cba6f7">if </span>[<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>      <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">17</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>        <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">17</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>        (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>          (<span style="color:#89dceb">string </span>[<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>]))))))
</span></span></code></pre></div><hr>
<h3 id="while">while</h3>
<p><code>while</code> statements in <code>hotshot</code> have the following syntax.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">while</span> <span style="color:#f5e0dc">condition</span> <span style="color:#f5e0dc">body</span>)
</span></span></code></pre></div><ul>
<li>The <code>body</code> is a single statement to execute. A <code>while</code> statement can return something.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/while.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>(<span style="color:#f5e0dc">while</span> <span style="color:#f5e0dc">true</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>    (<span style="color:#f5e0dc">echo</span> <span style="color:#a6e3a1">&#34;Infinity!&#34;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>(<span style="color:#f5e0dc">while</span> <span style="color:#f5e0dc">isTrue</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span> (<span style="color:#89dceb">do</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8">8</a></span><span>  (<span style="color:#cba6f7">let</span> <span style="color:#f5e0dc">isTrue</span> (<span style="color:#f5e0dc">checkSomething</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9">9</a></span><span>  <span style="color:#a6e3a1">&#34;It&#39;s true&#34;</span>))
</span></span></code></pre></div><ul>
<li>Code</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>      $.fcall,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>      $.<span style="color:#f38ba8">let</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      $.<span style="color:#cba6f7">if</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      $.<span style="color:#cba6f7">while</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>    <span style="color:#cba6f7">while</span><span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>      <span style="color:#a6e3a1">&#39;while&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>      field(<span style="color:#a6e3a1">&#39;condition&#39;</span>, $._returnable),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      field(<span style="color:#a6e3a1">&#39;body&#39;</span>, $.statement)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>    <span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>    <span style="color:#6c7086;font-style:italic">// Believe it or not, while statement are returnable
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _returnable<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.fcall , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">if</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">while</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>    ),
</span></span></code></pre></div><ul>
<li>Output</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">9</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">23</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    (<span style="color:#89b4fa">while</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>        (<span style="color:#89b4fa">boolean</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]))))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>    (<span style="color:#89b4fa">while</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>      <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>        (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">30</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>            <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">3</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>            <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>              (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>            <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">29</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span>              <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">29</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-25"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-25">25</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-26"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-26">26</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">2</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">8</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>])))))))
</span></span></code></pre></div><hr>
<h3 id="cond">cond</h3>
<p><code>cond</code> is a tricky statement.</p>
<p>It&rsquo;s syntax is this</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">cond</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>    (<span style="color:#89b4fa">condition1</span> <span style="color:#f5e0dc">body1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>    (<span style="color:#89b4fa">condition2</span> <span style="color:#f5e0dc">body2</span>))
</span></span></code></pre></div><ul>
<li>The <code>condition</code> is a <code>returnable</code> expression. The <code>body</code> is a single <code>statement</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/cond.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>(<span style="color:#89dceb">cond</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>    ((<span style="color:#f5e0dc">condition1</span>) <span style="color:#a6e3a1">&#34;condition1 is true&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>    ((<span style="color:#f5e0dc">condition2</span>) <span style="color:#a6e3a1">&#34;condition2 is true&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>    (<span style="color:#f5e0dc">true</span> <span style="color:#a6e3a1">&#34;nothing is true&#34;</span>))
</span></span></code></pre></div><ul>
<li>Code</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>      $.fcall,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>      $.<span style="color:#f38ba8">let</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      $.<span style="color:#cba6f7">if</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      $.<span style="color:#cba6f7">while</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>      $.cond
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>    cond<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(<span style="color:#a6e3a1">&#39;cond&#39;</span>, repeat(field(<span style="color:#a6e3a1">&#39;argument&#39;</span>, $.carg))),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>    carg<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(<span style="color:#a6e3a1">&#39;(&#39;</span>,field(<span style="color:#a6e3a1">&#39;condition&#39;</span>, $._returnable), field(<span style="color:#a6e3a1">&#39;body&#39;</span>, $.statement), <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>    <span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span><span style="color:#6c7086;font-style:italic"></span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>    _returnable<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.fcall , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">if</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">while</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.cond , <span style="color:#a6e3a1">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span><span style="color:#6c7086;font-style:italic">//....
</span></span></span></code></pre></div><ul>
<li>Output</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">7</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">29</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    (<span style="color:#cba6f7">cond </span>[<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">28</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">carg</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">39</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>        <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>            (<span style="color:#89b4fa">integer</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>        (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">38</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>          (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">38</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">38</span>]))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">carg</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">39</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>        <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">6</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>            (<span style="color:#89b4fa">integer</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">16</span>])))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>        (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">38</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>          (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">38</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">38</span>]))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">carg</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">28</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>        <span style="color:#f5e0dc">condition:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>          (<span style="color:#89b4fa">boolean</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">5</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span>        (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">27</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-25"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-25">25</a></span><span>          (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">27</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-26"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-26">26</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">27</span>])))))))
</span></span></code></pre></div><hr>
<h3 id="functions">functions</h3>
<p>Now that we have added support for <code>control-flow</code> statements, we can add support for function declaration.</p>
<p>This also includes <code>lambda</code> functions.</p>
<p>Functions have the following syntax</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span>(<span style="color:#89b4fa">fn</span> <span style="color:#f5e0dc">function-name</span> (<span style="color:#89b4fa">param1</span> <span style="color:#f5e0dc">param2</span>) <span style="color:#f5e0dc">body</span>)
</span></span></code></pre></div><ul>
<li><code>function-name</code> is a <code>identifier</code></li>
<li><code>paramN</code> is a <code>identifier</code></li>
<li><code>body</code> is a single statement</li>
</ul>
<p>Example</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/functions.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>(<span style="color:#f5e0dc">fn</span> <span style="color:#f5e0dc">hello</span>() (<span style="color:#f5e0dc">echo</span> <span style="color:#a6e3a1">&#34;Say hello&#34;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>(<span style="color:#f5e0dc">fn</span> <span style="color:#f5e0dc">add</span> (<span style="color:#f5e0dc">x</span> <span style="color:#f5e0dc">y</span>) (<span style="color:#f5e0dc">add</span> <span style="color:#f5e0dc">x</span> <span style="color:#f5e0dc">y</span>))
</span></span></code></pre></div><ul>
<li>Code</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>      $.fcall,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>      $.<span style="color:#f38ba8">let</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      $.<span style="color:#cba6f7">if</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      $.<span style="color:#cba6f7">while</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>      $.cond,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>      $.fdec
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>    fdec<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      <span style="color:#a6e3a1">&#39;fn&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>      field(<span style="color:#a6e3a1">&#39;name&#39;</span>, $.identifier),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>      <span style="color:#a6e3a1">&#39;(&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>      repeat(field(<span style="color:#a6e3a1">&#39;parameter&#39;</span>, $.identifier)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>      <span style="color:#a6e3a1">&#39;)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>      field(<span style="color:#a6e3a1">&#39;body&#39;</span>, $.statement),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span></code></pre></div><ul>
<li>Output</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">25</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">31</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    (<span style="color:#89b4fa">fdec</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">30</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">12</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">30</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">29</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">17</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">29</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>            (<span style="color:#89dceb">string </span>[<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">2</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">29</span>]))))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">23</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>    (<span style="color:#89b4fa">fdec</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>      <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">4</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">7</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>      <span style="color:#f5e0dc">parameter:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">8</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>      <span style="color:#f5e0dc">parameter:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">13</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">17</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>            (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>            (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">4</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>])))))))
</span></span></code></pre></div><hr>
<h3 id="lambda">lambda</h3>
<p><code>lambda</code> is a name-less function.</p>
<p>It&rsquo;s main function is to pass it around as a argument, to be used by other functions like <code>map</code>, <code>filter</code> etc.</p>
<p>You can bind it to a variable, meaning it is a <code>returnable</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lisp" data-lang="lisp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1">1</a></span><span><span style="color:#6c7086;font-style:italic">; programs/lambda.ht ;</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2">2</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3">3</a></span><span>(<span style="color:#89dceb">lambda</span> () <span style="color:#a6e3a1">&#34;something&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4">4</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5">5</a></span><span>(<span style="color:#89dceb">lambda</span> (<span style="color:#f5e0dc">x</span> <span style="color:#f5e0dc">y</span>) (<span style="color:#f5e0dc">add</span> <span style="color:#f5e0dc">x</span> <span style="color:#f5e0dc">y</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6">6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7">7</a></span><span>(<span style="color:#cba6f7">let</span> <span style="color:#f5e0dc">a</span> (<span style="color:#89dceb">lambda</span> () <span style="color:#a6e3a1">&#34;something&#34;</span>))
</span></span></code></pre></div><ul>
<li>The code is similar to <code>fdec</code>, but excludes the name of the function.</li>
<li>Also it&rsquo;s a <code>returnable</code>, unlike <code>fdec</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span><span style="color:#6c7086;font-style:italic"></span>    _paren<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>      $.fcall,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>      $.<span style="color:#f38ba8">let</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      $.<span style="color:#cba6f7">if</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>      $.<span style="color:#cba6f7">while</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>      $.cond,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>      $.fdec,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>      $.lambda
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>    lambda<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; seq(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>      <span style="color:#a6e3a1">&#39;lambda&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>      <span style="color:#a6e3a1">&#39;(&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>      repeat(field(<span style="color:#a6e3a1">&#39;argument&#39;</span>, $.identifier)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>      <span style="color:#a6e3a1">&#39;)&#39;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>      field(<span style="color:#a6e3a1">&#39;body&#39;</span>, $.statement),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-19"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-19">19</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-20"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-20">20</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-21"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-21">21</a></span><span>    _returnable<span style="color:#89dceb;font-weight:bold">:</span> $ =&gt; choice(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-22"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-22">22</a></span><span>      $.expression,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-23"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-23">23</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.fcall , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-24"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-24">24</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">if</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-25"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-25">25</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.<span style="color:#cba6f7">while</span> , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-26"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-26">26</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.cond , <span style="color:#a6e3a1">&#39;)&#39;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-27"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-27">27</a></span><span>      seq(<span style="color:#a6e3a1">&#39;(&#39;</span>, $.lambda , <span style="color:#a6e3a1">&#39;)&#39;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-28"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-28">28</a></span><span>    ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-29"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-29">29</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-30"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-30">30</a></span><span><span style="color:#6c7086;font-style:italic">//...
</span></span></span></code></pre></div><ul>
<li>Output</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-scheme" data-lang="scheme"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-1"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-1"> 1</a></span><span>(<span style="color:#89b4fa">source_file</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">6</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-2"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-2"> 2</a></span><span>  (<span style="color:#89b4fa">comment</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">0</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-3"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-3"> 3</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">23</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-4"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-4"> 4</a></span><span>    (<span style="color:#cba6f7">lambda </span>[<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-5"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-5"> 5</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-6"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-6"> 6</a></span><span>        (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-7"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-7"> 7</a></span><span>          (<span style="color:#89dceb">string </span>[<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">3</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>])))))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-8"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-8"> 8</a></span><span>  (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">0</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">24</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-9"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-9"> 9</a></span><span>    (<span style="color:#cba6f7">lambda </span>[<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">1</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">23</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-10"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-10">10</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">9</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">10</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-11"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-11">11</a></span><span>      <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">11</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">12</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-12"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-12">12</a></span><span>      <span style="color:#f5e0dc">body:</span> (<span style="color:#89b4fa">statement</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">14</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">23</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-13"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-13">13</a></span><span>        (<span style="color:#89b4fa">fcall</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-14"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-14">14</a></span><span>          <span style="color:#f5e0dc">name:</span> (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">15</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">18</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-15"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-15">15</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-16"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-16">16</a></span><span>            (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">19</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">20</span>]))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-17"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-17">17</a></span><span>          <span style="color:#f5e0dc">argument:</span> (<span style="color:#89b4fa">expression</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f849c" id="prefix-18"><a style="outline:none;text-decoration:none;color:inherit" href="#prefix-18">18</a></span><span>            (<span style="color:#89b4fa">identifier</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">21</span>] <span style="color:#f5e0dc">-</span> [<span style="color:#fab387">5</span><span style="color:#89dceb;font-weight:bold">,</span> <span style="color:#fab387">22</span>])))))))
</span></span></code></pre></div><hr>
<h2 id="testing">testing</h2>
<p>Ensure all the programs we wrote earlier are still parsing correctly.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ tree-sitter parse --quiet --stat programs/*.ht
</span></span></code></pre></div><p>It should give the following output.</p>
<div class="highlight"><pre tabindex="0" style="color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ Total parses: 9; successful parses: 9; failed parses: 0; success percentage: 100.00%; average speed: <span style="color:#fab387">6000</span> bytes/ms
</span></span></code></pre></div><hr>
<h2 id="end">end</h2>
<p>We have successfully implemented the parsing of a LISP-like language.</p>
<p>Parsing is useless if don&rsquo;t do anything with the AST.</p>
<p>We can implement</p>
<ul>
<li>Syntax Highlighting</li>
<li>Indentation</li>
<li>Select parts of code using tree-sitter queries.</li>
</ul>
<p>But there are some advantages to writing a tree-sitter parser like this.</p>
<ul>
<li>
<p>You can prototype your own language quickly using <code>tree-sitter</code> before writing a handwritten lexer/parser.</p>
</li>
<li>
<p>Having syntax highlighting to your custom language is useful while developing a <code>interpreter</code> or a <code>compiler</code> for it.</p>
</li>
</ul>
<blockquote>
<p>BTW <a href="https://github.com/pspiagicw/tree-sitter-hotshot">Hotshot&rsquo;s Tree-Sitter</a> can be referenced for the entire code.</p>
</blockquote>
<h2 id="next-post"><code>next-post</code></h2>
<p>We will learn how to implement <code>syntax-highlighting</code> along with tree-sitter <code>queries</code></p>
<p>We will also see how <code>nvim-treesitter</code> works with the <code>tree-sitter</code> library.</p>
<hr>
<h2 id="references"><code>references</code></h2>
<p>If want to make anything other than a <code>toy</code> langauge refer to these babes below.</p>
<ul>
<li>
<p><a href="https://tree-sitter.github.io/tree-sitter">official tree-sitter docs</a></p>
<p>Covers literally everything</p>
</li>
<li>
<p><a href="https://siraben.dev/2022/03/01/tree-sitter.html">Ben&rsquo;s Musing</a></p>
<p>Covers precedence, associativity, actual tree-sitter tests etc.</p>
</li>
<li>
<p><a href="https://www.jonashietala.se/blog/2024/03/19/lets_create_a_tree-sitter_grammar/">Jonas Hietala</a></p>
<p>Covers making custom scanners, embedding tree-sitter etc.</p>
</li>
</ul>

    </div>
</div>

            </main>
        </div>


        <footer class="footer">
    
        <span>Made with ♥  using Hugo.</span>
    
</footer>
    </div>

</body>

</html>