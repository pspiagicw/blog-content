<!DOCTYPE html>
<html lang="en-us">

<head>
    <title>
Python Project Starter | pspiagicw
</title>

    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="generator" content="Hugo 0.123.8">


<link rel="canonical" href="/posts/python-project-starter/" >
<link href="/sass/main.min.bd19d955a59805faafd36e2c4ce339deccbea14f3a0977897c5226c5fd96eda7.css" rel="stylesheet">



</head>

<body>

    <div class="flexWrapper">
        <header class="headerWrapper">
    <div class="header">
        <div>
            <a href="/">
                <span class="terminal">pspiagicw@falconite ~ $</span>
            </a>
        </div>
        <input class="side-menu" type="checkbox" id="side-menu">
        <label class="hamb" for="side-menu"><span class="hamb-line"></span></label>
        <nav class="headerLinks">
            <ul>
                
                <li>
                    <a href="/" title="" >
                        ~/home</a>
                </li>
                
                <li>
                    <a href="/posts" title="" >
                        ~/writing</a>
                </li>
                
                <li>
                    <a href="/about" title="" >
                        ~/about</a>
                </li>
                
            </ul>
        </nav>
    </div>
</header>


        <div class="content">
            <main class="main">
                
<div class="postWrapper">
    <h1>Python Project Starter</h1>
    
    <section class="postMetadata">
        <dl>
            
                
<dt>tags</dt>
<dd><span></span>
    <a href="/tags/linux/">#Linux</a><span></span>
    <a href="/tags/python/">#Python</a><span></span>
    <a href="/tags/devops/">#Devops</a></dd>
            
            
            
                
<dt>categories</dt>
<dd><span></span>
    <a href="/categories/python/">Python</a></dd>
            
            
                <dt>published</dt>
                
                <dd><time datetime="2022-12-23">December 23, 2022</time></dd>
            
            
                <dt>reading time</dt>
                <dd>6 minutes</dd>
            
        </dl>
    </section>
    
    <div>
        <p>I recently dived back into Python and got to build a fully featured Python application.
Here&rsquo;s how maybe you can setup a sick Python Project setup.</p>
<h2 id="dependencies">Dependencies</h2>
<p>For obvious reasons you need <code>pip</code> which is the package manager for Python.</p>
<p>You may use <code>pipx</code> which is what I use. It provides a isolated environment for every package installed through pip.
It is designed to be accompanied with command line tools written in Python.</p>
<p>A very good example for this would be the official <code>kaggle</code> command line tool.
Installing this through <code>pipx</code> means it is kept in a separate virtual environment and it&rsquo;s dependencies are tracked.
If any other command-line tool has the same dependency but with a different version it would not cause problems.</p>
<p>Another side effect of this is that when you delete a <code>pipx</code> package, it&rsquo;s dependencies are also deleted, which is not the default behaviour when using <code>pip</code>.</p>
<p>For following this tutorial you will need 2 python packages.</p>
<ul>
<li><code>poetry</code> It manages our Python project for us.</li>
<li><code>poethepoet</code> It is a task runner. You can run <code>make</code> but DOS/Windows users may face problem installing  and configuring <code>make</code>.By using <code>poethepoet</code> we use a os-agnostic task runner.</li>
</ul>
<p>You can install it using <code>pip</code> or <code>pipx</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pip install poetry poethepoet
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pipx install poetry
</span></span><span style="display:flex;"><span>pipx install poethepoet
</span></span></code></pre></div><h2 id="init"><code>init!</code></h2>
<p>Creating a project directory is trivial.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>poetry new &lt;project-name&gt;
</span></span></code></pre></div><p>This would create a new directory with the name <code>&lt;project-name&gt;</code>. It will ask you for some defaults simply answer them as you wish. You can change these later.</p>
<p>It would ask for your program dependencies.If you have any dependency in mind, please feel free to add them.</p>
<p>It will ask for development dependencies. I recommend skipping this question for now (To skip simply leave the prompt empty and press Enter).</p>
<p>Simply move into the new directory using <code>cd &lt;project-name&gt;</code></p>
<h2 id="dev"><code>dev!</code></h2>
<p>Let&rsquo;s install a few dependencies which will help you maintain a clean code. These are not the dependencies that the project uses to run.
These are only needed when developing/contributing to the project. That&rsquo;s the reason it is called the development dependencies.</p>
<p>Ofcourse development of any software is a subjective process. You can take help of any number of tools.</p>
<p>These are my suggestions</p>
<ul>
<li>
<p><code>black</code> is the formatter that I prefer. It is simple and non-intrusive. You are free to install any formatter that you currently use.</p>
</li>
<li>
<p><code>pytest</code> is the testing framework. I have never required anything beside <code>pytest</code>. Although if you need complex features you may install other testing frameworks</p>
</li>
<li>
<p><code>pydocstyle</code> ensures that all the code is documented. Especially useful when working on group projects where every little function may need to be documented.</p>
</li>
<li>
<p><code>pdoc</code> extracts the documentation from the code and converts into user friendly html format. You can use <code>sphinx</code> but it requires knowledge of <code>RST</code> format.
This might be a learning curve and ensuring everybody learns and uses it in a team is hard.</p>
</li>
<li>
<p><code>pre-commit</code> is the most important tool. It provides <code>git-hooks</code> which does not allow us to commit code without checking it through all the above programs.</p>
</li>
</ul>
<p>Keep in mind we are installing these tools in a development environment, not production. Thus we would need to tell poetry to add them to the dev dependencies.
To do the same run</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>poetry add -G dev black pytest pydocstyle pdoc pre-commit
</span></span></code></pre></div><p>This will not only create a new virtual environment for your dependencies but also create a <code>poetry.lock</code> file which will track all dependencies.</p>
<h2 id="pre-commit"><code>pre-commit!</code></h2>
<p>Let&rsquo;s configure <code>pre-commit</code>. For that we need a <code>.pre-commit-config.yml</code> file in the root of our project.</p>
<p>Populate the <code>.pre-commit-config.yml</code> file with the given content. For more information refer to the <code>pre-commit</code> documentation.</p>
<p>The given file configures some checks to be done before commiting any code. This includes</p>
<ul>
<li>formatting changes.</li>
<li>documentation validation.</li>
<li>misc things like trailing whitespaces.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">repos</span>:
</span></span><span style="display:flex;"><span>-   <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/pre-commit/pre-commit-hooks</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">v3.2.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hooks</span>:
</span></span><span style="display:flex;"><span>    -   <span style="color:#f92672">id</span>: <span style="color:#ae81ff">trailing-whitespace</span>
</span></span><span style="display:flex;"><span>    -   <span style="color:#f92672">id</span>: <span style="color:#ae81ff">end-of-file-fixer</span>
</span></span><span style="display:flex;"><span>    -   <span style="color:#f92672">id</span>: <span style="color:#ae81ff">check-yaml</span>
</span></span><span style="display:flex;"><span>    -   <span style="color:#f92672">id</span>: <span style="color:#ae81ff">check-added-large-files</span>
</span></span><span style="display:flex;"><span>-   <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/psf/black</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">22.3.0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hooks</span>:
</span></span><span style="display:flex;"><span>    -   <span style="color:#f92672">id</span>: <span style="color:#ae81ff">black</span>
</span></span><span style="display:flex;"><span>-   <span style="color:#f92672">repo</span>: <span style="color:#ae81ff">https://github.com/pycqa/pydocstyle</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">rev</span>: <span style="color:#ae81ff">6.1.1</span>  <span style="color:#75715e"># pick a git hash / tag to point to</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hooks</span>:
</span></span><span style="display:flex;"><span>    -   <span style="color:#f92672">id</span>: <span style="color:#ae81ff">pydocstyle</span>
</span></span></code></pre></div><p>Now is a good time to initialize <code>git</code>. Add the current folder to <code>git</code> and make a initial commit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># In the project root</span>
</span></span><span style="display:flex;"><span>git init
</span></span><span style="display:flex;"><span>git add .
</span></span><span style="display:flex;"><span>git commit -m <span style="color:#e6db74">&#34;Initial Commit&#34;</span>
</span></span></code></pre></div><h2 id="poethepoet"><code>poethepoet!</code></h2>
<p>Now we can configure the task runner. This would help you to run common tasks like formatting , testing without enabling the virtual environment.
<code>poethepoet</code> uses <code>pyproject.toml</code> file for the list of tasks.</p>
<p>You only need to append the following section</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[<span style="color:#a6e22e">tool</span>.<span style="color:#a6e22e">poe</span>.<span style="color:#a6e22e">tasks</span>]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">test</span> = <span style="color:#e6db74">&#34;pytest&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">run</span> = [<span style="color:#e6db74">&#34;doc&#34;</span>, { <span style="color:#a6e22e">shell</span> = <span style="color:#e6db74">&#34;python -m &lt;project-name&gt;&#34;</span>}]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">format</span> = [ { <span style="color:#a6e22e">shell</span> = <span style="color:#e6db74">&#34;black &lt;project-name&gt; tests&#34;</span>}]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">init</span> = [ { <span style="color:#a6e22e">shell</span> = <span style="color:#e6db74">&#34;poetry install&#34;</span>} , { <span style="color:#a6e22e">shell</span> = <span style="color:#e6db74">&#34;poetry run pre-commit install&#34;</span>} , { <span style="color:#a6e22e">shell</span> = <span style="color:#e6db74">&#34;poetry run pre-commit &#34;</span>} ]
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">doc</span> = <span style="color:#e6db74">&#34;pdoc -o docs &lt;project-name&gt;&#34;</span>
</span></span></code></pre></div><p>After adding this code you can run tasks using <code>poe</code>.</p>
<p>For example to format the entire code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>poe format
</span></span></code></pre></div><p>This would automatically run the formatting tool <code>black</code> within the virtual environment <code>poetry</code> created for us.
We don&rsquo;t have to manually run anything.</p>
<p>This is just the tip of the iceberg. We can run any tasks including building Docker images or deploying to PyPI.
Refer to the <code>poethepoet</code> documentation for more information.</p>
<p>To configure <code>pre-commit</code> and confirm every dependency is already installed. Run <code>poe init</code>.
This would make sure all dependencies are installed and configure pre-commit.</p>
<p>Until now <code>pre-commit</code> has not integrated with git. <code>poe init</code> takes care of doing this.
It will also run <code>pre-commit</code> for the first time to check if everything is working.</p>
<p>Because we have setup <code>pydocstyle</code> within <code>pre-commit</code> it may complain about missing documentation within the pre-generated code.</p>
<p>Everything we need will be inside the virtual environment. Isolation at it&rsquo;s peak!</p>
<h2 id="coding"><code>coding!</code></h2>
<p>Now the only thing remaining is coding!. Build your dream app.</p>
<p>The features provided through this process are</p>
<ul>
<li><code>pre-commit</code> for automatically formatting, checking and maintaining code quality</li>
<li><code>poethepoet</code> for a os-agnostic task runner. This will run irrespective of your operating system or dev environment.</li>
<li><code>poetry</code> for creating and managing a separate virtual environment. All dependencies will be handled by <code>poetry</code>.</li>
</ul>
<p>If you need others to run your software. You only need to tell them to install <code>poetry</code> and <code>poethepoet</code>.</p>
<p>Then clone the repository and run <code>poe init</code> within the project root. It will setup everything needed to develop and run your application.</p>
<p>Some tips:</p>
<ul>
<li>Adding non-development dependencies</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>poetry add &lt;dependency&gt;
</span></span></code></pre></div><ul>
<li>Add a cute .gitignore to ignore <code>__pycache__</code> folders and other build files.</li>
<li>If possible setup a Continous Integration workflow using GitHub Actions or any other CI service.</li>
<li>Maybe add a <code>Dockerfile</code> and make it more isolated.</li>
</ul>
<h2 id="errata"><code>errata!</code></h2>
<h2 id="printgoodbye-and-may-you-have-a-good-day"><code>print(&quot;Goodbye and may you have a good day!&quot;)</code></h2>

    </div>
</div>

            </main>
        </div>


        <footer class="footer">
    
        <span>Made with ♥  using Hugo.</span>
    
</footer>
    </div>

</body>

</html>